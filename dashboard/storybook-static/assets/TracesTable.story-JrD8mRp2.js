import{j as s,r as a,B as V}from"./iframe-ByZyHG7Z.js";import{c as B}from"./table-BuDuxKCV.js";import{T as j,b as U}from"./TracesTable.component-v8FAYs_j.js";import{S as A}from"./Stack-BYgy4ZNY.js";import{T as G}from"./Title-Czq4HMLJ.js";import{T as H}from"./TextInput-Ba5dtmf_.js";import{I as J}from"./IconSearch-Dks1vVM2.js";import"./preload-helper-PPVm8Dsz.js";import"./createReactComponent-Cbgg6bZD.js";import"./find-element-ancestor-Cv-4bSct.js";import"./error-eSvF7V3U.js";import"./format-BWW3-KEh.js";import"./IconAlertCircle-BKZdSC5f.js";import"./IconFileDescription-BKfQSike.js";const ie={title:"Components/TracesTable",component:j,parameters:{layout:"fullscreen"}},e=Math.floor(1762775145209/1e3),v=[{rolloutId:"ro-trace-001",attemptId:"at-trace-001",sequenceId:1,traceId:"trace-abc123def456",spanId:"span-root-001",parentId:null,name:"main_task",status:{status_code:"OK",description:null},attributes:{"task.type":"generation","task.priority":"high","user.id":"user-123"},startTime:e-100,endTime:e-10,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-trace-001",attemptId:"at-trace-001",sequenceId:1,traceId:"trace-abc123def456",spanId:"span-child-001",parentId:"span-root-001",name:"llm_call",status:{status_code:"OK",description:null},attributes:{"llm.model":"gpt-4","llm.temperature":.7,"llm.max_tokens":2048},startTime:e-90,endTime:e-50,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-trace-001",attemptId:"at-trace-001",sequenceId:1,traceId:"trace-abc123def456",spanId:"span-child-002",parentId:"span-root-001",name:"database_query",status:{status_code:"OK",description:null},attributes:{"db.system":"postgresql","db.operation":"SELECT","db.table":"users"},startTime:e-80,endTime:e-70,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-trace-002",attemptId:"at-trace-002",sequenceId:1,traceId:"trace-xyz789ghi012",spanId:"span-error-001",parentId:"span-missing-parent",name:"failed_operation",status:{status_code:"ERROR",description:"Connection timeout"},attributes:{"error.type":"TimeoutError","error.message":"Connection timed out after 30s"},startTime:e-150,endTime:e-120,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-trace-003",attemptId:"at-trace-003",sequenceId:1,traceId:"trace-unset123",spanId:"span-unset-001",parentId:null,name:"pending_task",status:{status_code:"UNSET",description:null},attributes:{},startTime:e-30,endTime:e-5,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-trace-004",attemptId:"at-trace-004",sequenceId:2,traceId:"trace-nested456",spanId:"span-parent-001",parentId:null,name:"workflow_execution",status:{status_code:"OK",description:null},attributes:{"workflow.name":"data_processing","workflow.version":"2.1.0"},startTime:e-200,endTime:e-50,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-trace-004",attemptId:"at-trace-004",sequenceId:2,traceId:"trace-nested456",spanId:"span-child-nested-001",parentId:"span-parent-001",name:"step_1_validation",status:{status_code:"OK",description:null},attributes:{"step.name":"validation","step.index":1},startTime:e-195,endTime:e-180,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-trace-004",attemptId:"at-trace-004",sequenceId:2,traceId:"trace-nested456",spanId:"span-child-nested-002",parentId:"span-parent-001",name:"step_2_processing",status:{status_code:"ERROR",description:"Validation failed"},attributes:{"step.name":"processing","step.index":2,"error.type":"ValidationError"},startTime:e-175,endTime:e-160,events:[],links:[],context:{},parent:null,resource:{}}];function r({maxWidth:o,spans:_=v,isFetching:O=!1,isError:C=!1,error:E=null}){const[c,g]=a.useState(""),[b,k]=a.useState(1),[d,K]=a.useState(10),[l,w]=a.useState({column:"startTime",direction:"desc"}),f=a.useMemo(()=>_?_.map(t=>U(t)):[],[_]),y=a.useMemo(()=>{const t=c.trim().toLowerCase();return t.length===0?f:f.filter(n=>n.traceId.toLowerCase().includes(t)||n.spanId.toLowerCase().includes(t)||n.name.toLowerCase().includes(t))},[c,f]),W=a.useMemo(()=>{const t=y.slice();if(!t.length)return t;const n=l.column;return n in t[0]&&(t.sort((z,F)=>B(z,F,n)),l.direction==="desc"&&t.reverse()),t},[y,l]),P=W.length,R=a.useMemo(()=>{const t=(b-1)*d,n=t+d;return W.slice(t,n)},[b,d,W]),M=a.useMemo(()=>R.map(t=>t),[R]),N=t=>{console.log("Show rollout for:",t.rolloutId)},L=t=>{console.log("Show span detail for:",t.spanId,t)},D=t=>{console.log("Navigate to parent span:",t),g(t)};return s.jsx(V,{mx:"auto",style:{maxWidth:o,width:"100%",padding:16},children:s.jsxs(A,{gap:"md",children:[s.jsx(G,{order:2,children:"Traces"}),s.jsx(H,{placeholder:"Search by Trace ID, Span ID, or Name",value:c,onChange:t=>g(t.currentTarget.value),leftSection:s.jsx(J,{size:16}),"data-testid":"traces-search-input",w:"100%",style:{maxWidth:360}}),s.jsx(j,{spans:M,totalRecords:P,isFetching:O,isError:C,error:E,searchTerm:c,sort:l,page:b,recordsPerPage:d,onSortStatusChange:t=>{w({column:t.columnAccessor,direction:t.direction})},onPageChange:k,onRecordsPerPageChange:t=>{K(t),k(1)},onResetFilters:()=>{g(""),w({column:"startTime",direction:"desc"}),k(1)},onRefetch:()=>{},onShowRollout:N,onShowSpanDetail:L,onParentIdClick:D,recordsPerPageOptions:[10,20,50]})]})})}const i={render:()=>s.jsx(r,{maxWidth:1400})},p={render:()=>s.jsx(r,{maxWidth:960})},u={render:()=>s.jsx(r,{maxWidth:720})},m={render:()=>s.jsx(r,{maxWidth:520})},I={render:()=>s.jsx(r,{maxWidth:960,spans:[],isError:!0,error:new Error("Network unreachable")})},T={render:()=>s.jsx(r,{maxWidth:960,spans:[],isFetching:!0})},q={render:()=>s.jsx(r,{maxWidth:960,spans:[]})},x={render:()=>s.jsx(r,{maxWidth:1200,spans:v.filter(o=>o.spanId==="span-error-001")})},h={render:()=>s.jsx(r,{maxWidth:1200,spans:v.filter(o=>o.traceId==="trace-nested456")})},Q=[{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:2,traceId:"trace-seq-002",spanId:"span-seq-002",parentId:null,name:"task_sequence_2",status:{status_code:"OK",description:null},attributes:{},startTime:e-200,endTime:e-190,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:10,traceId:"trace-seq-010",spanId:"span-seq-010",parentId:null,name:"task_sequence_10",status:{status_code:"OK",description:null},attributes:{},startTime:e-180,endTime:e-170,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:3,traceId:"trace-seq-003",spanId:"span-seq-003",parentId:null,name:"task_sequence_3",status:{status_code:"OK",description:null},attributes:{},startTime:e-160,endTime:e-150,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:11,traceId:"trace-seq-011",spanId:"span-seq-011",parentId:null,name:"task_sequence_11",status:{status_code:"OK",description:null},attributes:{},startTime:e-140,endTime:e-130,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:9,traceId:"trace-seq-009",spanId:"span-seq-009",parentId:null,name:"task_sequence_9",status:{status_code:"OK",description:null},attributes:{},startTime:e-120,endTime:e-110,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:12,traceId:"trace-seq-012",spanId:"span-seq-012",parentId:null,name:"task_sequence_12",status:{status_code:"OK",description:null},attributes:{},startTime:e-100,endTime:e-90,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:4,traceId:"trace-seq-004",spanId:"span-seq-004",parentId:null,name:"task_sequence_4",status:{status_code:"OK",description:null},attributes:{},startTime:e-80,endTime:e-70,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:6,traceId:"trace-seq-006",spanId:"span-seq-006",parentId:null,name:"task_sequence_6",status:{status_code:"OK",description:null},attributes:{},startTime:e-60,endTime:e-50,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:7,traceId:"trace-seq-007",spanId:"span-seq-007",parentId:null,name:"task_sequence_7",status:{status_code:"OK",description:null},attributes:{},startTime:e-40,endTime:e-30,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:13,traceId:"trace-seq-013",spanId:"span-seq-013",parentId:null,name:"task_sequence_13",status:{status_code:"OK",description:null},attributes:{},startTime:e-20,endTime:e-10,events:[],links:[],context:{},parent:null,resource:{}},{rolloutId:"ro-seq-test",attemptId:"at-seq-test",sequenceId:14,traceId:"trace-seq-014",spanId:"span-seq-014",parentId:null,name:"task_sequence_14",status:{status_code:"UNSET",description:null},attributes:{},startTime:e-5,endTime:e,events:[],links:[],context:{},parent:null,resource:{}}],S={render:()=>s.jsx(r,{maxWidth:1200,spans:Q})};i.parameters={...i.parameters,docs:{...i.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={1400} />
}`,...i.parameters?.docs?.source}}};p.parameters={...p.parameters,docs:{...p.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={960} />
}`,...p.parameters?.docs?.source}}};u.parameters={...u.parameters,docs:{...u.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={720} />
}`,...u.parameters?.docs?.source}}};m.parameters={...m.parameters,docs:{...m.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={520} />
}`,...m.parameters?.docs?.source}}};I.parameters={...I.parameters,docs:{...I.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={960} spans={[]} isError error={new Error('Network unreachable')} />
}`,...I.parameters?.docs?.source}}};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={960} spans={[]} isFetching />
}`,...T.parameters?.docs?.source}}};q.parameters={...q.parameters,docs:{...q.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={960} spans={[]} />
}`,...q.parameters?.docs?.source}}};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={1200} spans={sampleSpans.filter(s => s.spanId === 'span-error-001')} />
}`,...x.parameters?.docs?.source}}};h.parameters={...h.parameters,docs:{...h.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={1200} spans={sampleSpans.filter(s => s.traceId === 'trace-nested456')} />
}`,...h.parameters?.docs?.source}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  render: () => <TracesTableStoryWrapper maxWidth={1200} spans={sequenceSortTestSpans} />
}`,...S.parameters?.docs?.source}}};export{m as DrawerWidth,q as EmptyState,I as ErrorState,T as LoadingState,p as MediumContainer,u as NarrowContainer,h as NestedSpans,S as SequenceIdSortTest,i as WideContainer,x as WithMissingParent,ie as default};
