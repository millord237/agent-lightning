import{j as o,r,B as D,b as O}from"./iframe-ByZyHG7Z.js";import{c as z}from"./table-BuDuxKCV.js";import{R as v,b as _}from"./RolloutTable.component-C1WClHvj.js";import{S as B}from"./Stack-BYgy4ZNY.js";import{T as G}from"./Title-Czq4HMLJ.js";import{T as L}from"./TextInput-Ba5dtmf_.js";import{I as K}from"./IconSearch-Dks1vVM2.js";import"./preload-helper-PPVm8Dsz.js";import"./createReactComponent-Cbgg6bZD.js";import"./find-element-ancestor-Cv-4bSct.js";import"./format-BWW3-KEh.js";import"./IconFileDescription-BKfQSike.js";import"./IconTimeline-BvsfcN9Y.js";import"./IconAlertCircle-BKZdSC5f.js";const le={title:"Components/RolloutTable",component:v,parameters:{layout:"fullscreen"}},t=O,V=[{rolloutId:"ro-story-001",input:{task:"Generate onboarding summary"},startTime:t-3200,endTime:null,mode:"train",resourcesId:"rs-story-001",status:"running",config:{retries:1},metadata:{owner:"alice"},attempt:{rolloutId:"ro-story-001",attemptId:"at-story-010",sequenceId:1,startTime:t-3200,endTime:null,status:"running",workerId:"worker-east",lastHeartbeatTime:t-45,metadata:{info:"Worker is processing"}}},{rolloutId:"ro-story-002",input:{task:"Classify feedback tickets"},startTime:t-7200,endTime:t-5400,mode:"val",resourcesId:"rs-story-002",status:"succeeded",config:{retries:2},metadata:{owner:"bob"},attempt:{rolloutId:"ro-story-002",attemptId:"at-story-011",sequenceId:2,startTime:t-6200,endTime:t-5400,status:"succeeded",workerId:"worker-north",lastHeartbeatTime:t-5400,metadata:{previousAttempt:"at-story-010"}}},{rolloutId:"ro-story-003",input:{task:"Analyze experiment results"},startTime:t-10800,endTime:t-9600,mode:"test",resourcesId:"rs-story-003",status:"failed",config:{retries:1},metadata:{owner:"carol"},attempt:{rolloutId:"ro-story-003",attemptId:"at-story-012",sequenceId:3,startTime:t-10200,endTime:t-9600,status:"failed",workerId:"worker-west",lastHeartbeatTime:t-9600,metadata:{reason:"Timeout"}}},{rolloutId:"ro-story-004",input:{task:"Evaluate prompt variants"},startTime:t-3600,endTime:null,mode:"train",resourcesId:null,status:"preparing",config:{retries:0},metadata:{owner:"dave"},attempt:null},{rolloutId:"ro-story-005",input:{task:"Generate quick answers"},startTime:t-1800,endTime:null,mode:"val",resourcesId:"rs-story-004",status:"running",config:{retries:0},metadata:{owner:"eva"},attempt:{rolloutId:"ro-story-005",attemptId:"at-story-013",sequenceId:1,startTime:t-1800,endTime:null,status:"running",workerId:null,lastHeartbeatTime:t-75,metadata:null}},{rolloutId:"ro-story-006",input:{task:"Compile release notes"},startTime:t-9600,endTime:t-9e3,mode:null,resourcesId:"rs-story-005",status:"cancelled",config:{retries:3},metadata:null,attempt:{rolloutId:"ro-story-006",attemptId:"at-story-014",sequenceId:1,startTime:t-9600,endTime:t-9e3,status:"timeout",workerId:"worker-south",lastHeartbeatTime:t-9e3,metadata:{info:"Cancelled by operator"}}}];function n({maxWidth:E,rollouts:I=V,isFetching:M=!1,isError:P=!1,error:F=null}){const[l,b]=r.useState(""),[i,y]=r.useState([]),[d,S]=r.useState([]),[f,a]=r.useState(1),[m,q]=r.useState(5),[u,k]=r.useState({column:"startTimestamp",direction:"desc"}),W=r.useMemo(()=>I?I.map(e=>_(e)):[],[I]),C=r.useMemo(()=>{const e=l.trim().toLowerCase();return W.filter(s=>{const R=e.length===0||s.rolloutId.toLowerCase().includes(e),w=i.length===0||i.includes(s.status),A=d.length===0||s.mode!==null&&d.includes(s.mode);return R&&w&&A})},[d,l,i,W]),x=r.useMemo(()=>{const e=C.slice();if(!e.length)return e;const s=u.column;return s in e[0]&&(e.sort((R,w)=>z(R,w,s)),u.direction==="desc"&&e.reverse()),e},[C,u]),H=x.length,j=r.useMemo(()=>{const e=(f-1)*m,s=e+m;return x.slice(e,s)},[f,m,x]),N=r.useMemo(()=>j.map(e=>e),[j]);return o.jsx(D,{mx:"auto",style:{maxWidth:E,width:"100%",padding:16},children:o.jsxs(B,{gap:"md",children:[o.jsx(G,{order:2,children:"Rollouts"}),o.jsx(L,{placeholder:"Search by Rollout ID",value:l,onChange:e=>b(e.currentTarget.value),leftSection:o.jsx(K,{size:16}),"data-testid":"rollouts-search-input",w:"100%",style:{maxWidth:360}}),o.jsx(v,{rollouts:N,totalRecords:H,isFetching:M,isError:P,error:F,searchTerm:l,statusFilters:i,modeFilters:d,sort:u,page:f,recordsPerPage:m,onStatusFilterChange:e=>{y(e),a(1)},onStatusFilterReset:()=>{y([]),a(1)},onModeFilterChange:e=>{S(e),a(1)},onModeFilterReset:()=>{S([]),a(1)},onSortStatusChange:e=>{k({column:e.columnAccessor,direction:e.direction})},onPageChange:a,onRecordsPerPageChange:e=>{q(e),a(1)},onResetFilters:()=>{b(""),y([]),S([]),k({column:"startTimestamp",direction:"desc"}),a(1)},onRefetch:()=>{},recordsPerPageOptions:[5,10,20]})]})})}const c={render:()=>o.jsx(n,{maxWidth:1280})},p={render:()=>o.jsx(n,{maxWidth:960})},T={render:()=>o.jsx(n,{maxWidth:720})},h={render:()=>o.jsx(n,{maxWidth:520})},g={render:()=>o.jsx(n,{maxWidth:600,rollouts:[],isError:!0,error:new Error("Network unreachable")})};c.parameters={...c.parameters,docs:{...c.parameters?.docs,source:{originalSource:`{
  render: () => <RolloutTableStoryWrapper maxWidth={1280} />
}`,...c.parameters?.docs?.source}}};p.parameters={...p.parameters,docs:{...p.parameters?.docs,source:{originalSource:`{
  render: () => <RolloutTableStoryWrapper maxWidth={960} />
}`,...p.parameters?.docs?.source}}};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:`{
  render: () => <RolloutTableStoryWrapper maxWidth={720} />
}`,...T.parameters?.docs?.source}}};h.parameters={...h.parameters,docs:{...h.parameters?.docs,source:{originalSource:`{
  render: () => <RolloutTableStoryWrapper maxWidth={520} />
}`,...h.parameters?.docs?.source}}};g.parameters={...g.parameters,docs:{...g.parameters?.docs,source:{originalSource:`{
  render: () => <RolloutTableStoryWrapper maxWidth={600} rollouts={[]} isError error={new Error('Network unreachable')} />
}`,...g.parameters?.docs?.source}}};export{h as DrawerWidth,g as ErrorState,p as MediumContainer,T as NarrowContainer,c as WideContainer,le as default};
